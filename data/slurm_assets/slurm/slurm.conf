ClusterName=@CLUSTER_NAME@

# MCS
MCSPlugin=mcs/label
MCSParameters=ondemand,ondemandselect

SlurmUser=slurm
SlurmdUser=root
SlurmdPort=6818
SlurmctldPort=6817
SlurmctldHost=@HEADNODE_HOSTNAME@
SlurmctldAddr=@HEADNODE_ADDRESS@

AuthType=auth/slurm
CredType=auth/slurm

AuthAltParameters=jwt_key=/etc/slurm/jwt_hs256.key
AuthAltTypes=auth/jwt

AuthInfo=use_client_ids

SlurmctldPidFile=/run/slurmctld/slurmctld.pid
SlurmdPidFile=/run/slurmd/slurmd.pid

SlurmctldLogFile=/var/log/slurm/slurmctld.log
SlurmdLogFile=/var/log/slurm/slurmd.log

SlurmdSpoolDir=/var/lib/slurm/slurmd
StateSaveLocation=/var/lib/slurm/checkpoint

PluginDir=/opt/slurm/view/lib/slurm

PlugStackConfig=/etc/slurm/plugstack.conf

ProctrackType=proctrack/cgroup

ReturnToService=2
RebootProgram="/usr/sbin/reboot --reboot"
MailProg=/usr/bin/mail.mailutils

# Timers
SlurmctldTimeout=300
SlurmdTimeout=60
InactiveLimit=0
MinJobAge=86400
KillWait=30
Waittime=0

# Scheduling
SchedulerType=sched/backfill
SelectType=select/cons_tres
SelectTypeParameters=CR_CPU_Memory

# Logging
SlurmctldDebug=debug5
SlurmdDebug=debug5

# Accounting
AcctGatherProfileType=acct_gather_profile/influxdb
AcctGatherNodeFreq=10
JobAcctGatherType=jobacct_gather/cgroup
JobAcctGatherFrequency="task=5"

TaskPlugin="task/cgroup,task/affinity"

# Slurmdbd
AccountingStorageType=accounting_storage/slurmdbd
AccountingStorageHost=@HEADNODE_ADDRESS@
AccountingStorageUser=slurm
AccountingStoragePort=6819

# Node Configurations
NodeName=@HEADNODE_HOSTNAME@ NodeAddr=@HEADNODE_ADDRESS@ CPUs=@CPUs@ ThreadsPerCore=@THREADS_PER_CORE@ CoresPerSocket=@CORES_PER_SOCKET@ Sockets=@SOCKETS@ RealMemory=@REAL_MEMORY@

# Partition Configurations
PartitionName=compute Nodes=@HEADNODE_HOSTNAME@ MaxTime=INFINITE State=UP Default=Yes

# Nodeset
NodeSet=compute Feature=compute
